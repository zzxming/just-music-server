import{d as T,g as y,h as B,o as v,c as P,b as a,w as f,F as $,i as D,f as F,a as c,j as S,t as L,k as x,P as E,m as V,l as q,n as R,u as z,e as p,_ as I,p as N,q as O,s as j,v as A,x as H,y as w,z as X,A as Y,B as G}from"./index.d3614d96.js";import{L as J,a as K}from"./index.4748948e.js";const Q={class:"playlist_list"},U=["onClick","onContextmenu"],W={class:"playlist_list_item-cover"},Z={class:"playlist_list_item-playcount"},tt=["src"],et={class:"playlist_list_item-title"},st=T({__name:"index",props:{isTopList:{type:Boolean},playlist:null},setup(n){const g=y("/api/imgs/music.jpg"),l=z(),r=B(),{setPopoutState:i}=r;function _(t){return t>1e8?`${Math.floor(t/1e8)}\u4EBF`:t>1e4?`${Math.floor(t/1e4)}\u4E07`:`${t}`}function m(t,e){l.push(`/playlist/detail?id=${t}&t=${e}`)}function u(t){t.target.src=g.value}function s(t,e){t.preventDefault(),i({popoutVisible:!0,popoutPosition:{left:t.pageX,top:t.pageY},popoutHoldData:e,popoutIsMusic:!1,popoutCanDelete:!1})}return(t,e)=>{const d=p("VideoPlay"),C=p("el-icon"),M=p("CaretRight"),b=p("el-col"),k=p("el-row");return v(),P("ul",Q,[a(k,{gutter:20,class:R(`playlist_list_row ${n.isTopList?"toplist":""}`)},{default:f(()=>[(v(!0),P($,null,D(n.playlist,o=>(v(),F(b,{class:"playlist_list_wrap"},{default:f(()=>[c("div",{class:"playlist_list_item",onClick:h=>m(o.id,o.type),onContextmenu:h=>s(h,o)},[c("div",W,[a(C,{class:"playlist_list_item-icon play"},{default:f(()=>[a(d)]),_:1}),c("span",Z,[a(C,{class:"playlist_list_item-icon allow-right"},{default:f(()=>[a(M)]),_:1}),S(" "+L(_(o.playCount)),1)]),c("img",{class:"playlist_list_item-img",src:o.type===x(E).local?x(V)(o.cover):o.cover,onError:e[0]||(e[0]=h=>x(q.exports.throttle)(u,3e3))},null,40,tt)]),c("div",et,L(o.title),1)],40,U)]),_:2},1024))),256))]),_:1},8,["class"])])}}});const ot=I(st,[["__scopeId","data-v-906af92d"]]),at={class:"playlist"},lt=T({__name:"index",props:{isTopList:{type:Boolean,default:!1,required:!1}},setup(n){const{isTopList:g}=n,l=y(),r=y(!1),i=y(!0),_=N([]);O(()=>{u()}),j(i,s=>{s||Y(()=>m())});function m(){if(!l.value)return;new IntersectionObserver(function(t){t[0].isIntersecting&&l.value&&l.value.loadFunc()},{rootMargin:"0px 0px 200px 0px"}).observe(l.value.loadMore)}async function u(){r.value=!1;let[s,t]=await A({limit:g?20:10});if(!s&&t){const{code:e,data:d}=t.data;return _.push(...H(d,E.cloud)),i.value=!1,d.length}return s&&(r.value=!0),-1}return(s,t)=>{const e=G("loading");return v(),P($,null,[c("div",at,[w(a(ot,{isTopList:n.isTopList,playlist:_},null,8,["isTopList","playlist"]),[[e,i.value&&!r.value]]),a(J,{isError:i.value&&r.value,requestFunc:u},null,8,["isError"])]),w(a(K,{ref_key:"loadMore",ref:l,requestFunc:u},null,512),[[X,n.isTopList&&!i.value]])],64)}}});const rt=I(lt,[["__scopeId","data-v-4ffdb11e"]]);export{rt as C,ot as P};
