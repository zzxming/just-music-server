import{d as H,g as d,p as J,s as N,q as Q,P as n,a4 as F,a5 as X,a6 as Y,a7 as Z,a2 as $,o as r,c as f,b as k,y as u,a,k as y,t as g,f as T,j as ee,F as ae,z as w,w as O,I as B,u as te,a8 as le,O as se,K as q,a9 as oe,aa as ie,e as P,B as z,m as V,ab as ne,M as re,N as ce,A as ue,_ as _e}from"./index.d3614d96.js";import{a as de,S as pe,b as ve}from"./index.2db69e03.js";import{L as fe,a as ye}from"./index.4748948e.js";const A=m=>(re("data-v-508d854e"),m=m(),ce(),m),ge={class:"playlist"},me={class:"playlist_wrapper"},he={key:0,class:"playlist_info"},Se={class:"playlist_info_left"},ke={class:"playlist_info_cover"},we={class:"playlist_info_right"},Ce={class:"playlist_info_right_line"},Ie=["title"],Pe={class:"playlist_info_right_line"},xe={class:"playlist_info_nickname"},De={class:"playlist_info_createTime"},Te={class:"playlist_info_right_line"},Be={class:"playlise_info_playinfo"},Ee=A(()=>a("span",{class:"playlist_info-tip"},"\u6B4C\u66F2:",-1)),be={class:"playlist_info_right_line"},Le={class:"playlist_info_description"},Me=A(()=>a("span",{class:"playlist_info-tip"},"\u7B80\u4ECB:",-1)),Ne={key:0},Fe={class:"playlist_song"},Oe=H({__name:"index",props:{id:null,t:null},setup(m){const o=m,E=te(),p=d(!0),x=d(!1),b=d(!1),_=J([]),e=d(),v=d(!1),D=d(1),h=d();function U(){var l;if(!((l=h.value)!=null&&l.loadMore))return;new IntersectionObserver(function(s){s[0].isIntersecting&&h.value&&h.value.loadFunc()},{rootMargin:"0px 0px 400px 0px"}).observe(h.value.loadMore)}N([()=>o.id,()=>o.t],()=>{_.length=0,C()},{immediate:!0}),N(e,()=>{ue(()=>U())}),Q(()=>{o.t===n.localStorage&&window.addEventListener(F,C)}),X(()=>{window.removeEventListener(F,C)});async function C(){if(o.t===n.localStorage){p.value=!0;let t=Y(Number(o.id));t?(e.value=t,_.length=0,_.push(...t.tracks)):E.replace("/404"),p.value=!1;return}W(Number(o.id),o.t)}async function W(t,l){p.value=!0,x.value=!1;let[s,i]=l===n.local?await de({id:t}):await Z({id:t});if(p.value=!1,!s&&i){let{code:c,data:I}=i.data;return e.value=$(I,l),!0}else return E.replace("/404"),x.value=!0,!1}async function j(t,l,s=!1){b.value=!1;let[i,c]=l===n.local?await ve({id:t,limit:D.value}):await le({id:t,limit:D.value});if(!i&&c){let{code:I,data:S}=c.data;return s||(_.length=0),_.push(...se(S,l===n.cloud?q.cloud:q.local)),D.value+=1,S.length}else return b.value=!0,-1}function K(){v.value=!v.value}function R(t){if(!e.value||e.value.type!==n.localStorage)return;let l={...e.value};l.tracks=t;let s=oe(),i=s.findIndex(c=>c.id===l.id);i!==-1&&(s.splice(i,1,l),ie(s))}return(t,l)=>{var L,M;const s=P("el-avatar"),i=P("CaretTop"),c=P("el-icon"),I=P("CaretBottom"),S=z("lazy"),G=z("loading");return r(),f("div",ge,[k(fe,{isError:!p.value&&x.value,requestFunc:C},null,8,["isError"]),u((r(),f("div",me,[e.value?(r(),f("div",he,[a("div",Se,[a("div",ke,[u((r(),f("img",{alt:"\u6B4C\u5355\u5C01\u9762",key:e.value.cover})),[[S,y(V)(e.value.cover)]])])]),a("div",we,[a("div",Ce,[a("h3",{class:"playlist_info_title",title:e.value.title},g(e.value.title),9,Ie)]),a("div",Pe,[u((r(),T(s,{class:"playlist_info_avatar",size:28,icon:y(ne),key:e.value.creator.avatarUrl},null,8,["icon"])),[[S,y(V)(e.value.creator.avatarUrl)]]),a("span",xe,g(e.value.creator.name),1),a("span",De,g(e.value.createTime===0?"":new Date(e.value.createTime).toLocaleDateString()),1)]),a("div",Te,[a("div",Be,[Ee,ee(g(e.value.trackCount),1)])]),a("div",be,[a("div",Le,[Me,e.value.description===""?(r(),f("span",Ne,"\u65E0")):(r(),f(ae,{key:1},[u(a("span",{class:"playlist_info_description-title"},g(e.value.description),513),[[w,!v.value]]),u(a("span",{class:"playlist_info_description-full"},g(e.value.description),513),[[w,v.value]]),a("span",{class:"playlist_info_description-arrow",onClick:K},[u(k(c,null,{default:O(()=>[k(i)]),_:1},512),[[w,v.value]]),u(k(c,null,{default:O(()=>[k(I)]),_:1},512),[[w,!v.value]])])],64))])])])])):B("",!0),u(a("div",Fe,[_?(r(),T(pe,{key:0,songs:_,canDeleteSong:((L=e.value)==null?void 0:L.type)===y(n).localStorage,canDrag:((M=e.value)==null?void 0:M.type)===y(n).localStorage,onSongOrder:R},null,8,["songs","canDeleteSong","canDrag"])):B("",!0),o.t!==y(n).localStorage&&e.value?(r(),T(ye,{key:"loadingSong",ref_key:"loadMore",ref:h,requestFunc:j.bind(void 0,Number(o.id),o.t,!0)},null,8,["requestFunc"])):B("",!0)],512),[[w,e.value]])])),[[G,p.value&&!e.value]])])}}});const Ae=_e(Oe,[["__scopeId","data-v-508d854e"]]);export{Ae as default};
