import{i as ie,ah as ne,q as R,ai as ce,j as re,d as T,p as ue,r as h,l as z,aj as _e,ak as de,M as Y,b as n,c as _,n as W,z as d,x as F,g as I,A as pe,E as Z,h as ve,y as fe,B as me,C as he,f as a,a as ye,o as ge,P as o,al as U,am as Se,an as j,ao as we,ag as Ce,Y as ke,v as be,w as S,e as w,I as O,t as b,Z as Pe,J as H,F as Ee,Q as E,u as Ie,ap as Be,a2 as De,$ as J,aq as $e,ar as ze,a5 as Fe,K,a6 as Te,a7 as xe,as as Le,a0 as Q,at as Ne,_ as Me}from"./index.93b487f7.js";import{_ as Ae}from"./index.141f7ffc.js";import{_ as qe}from"./index.6754e4d5.js";import{g as Ve,b as We,s as Ue,c as je}from"./localApi.ce7fb414.js";import"./more-outlined.22939d11.js";const Oe=ie({size:{type:[Number,String],values:ne,default:"",validator:c=>R(c)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:ce},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:re(String),default:"cover"}}),He={error:c=>c instanceof Event},Je=["src","alt","srcset"],Ke=T({name:"ElAvatar"}),Qe=T({...Ke,props:Oe,emits:He,setup(c,{emit:t}){const C=c,r=ue("avatar"),k=h(!1),B=z(()=>{const{size:s,icon:P,shape:g}=C,m=[r.b()];return _e(s)&&m.push(r.m(s)),P&&m.push(r.m("icon")),g&&m.push(r.m(g)),m}),f=z(()=>{const{size:s}=C;return R(s)?r.cssVarBlock({size:de(s)||""}):void 0}),e=z(()=>({objectFit:C.fit}));Y(()=>C.src,()=>k.value=!1);function y(s){k.value=!0,t("error",s)}return(s,P)=>(n(),_("span",{class:fe(d(B)),style:W(d(f))},[(s.src||s.srcSet)&&!k.value?(n(),_("img",{key:0,src:s.src,alt:s.alt,srcset:s.srcSet,style:W(d(e)),onError:y},null,44,Je)):s.icon?(n(),F(d(Z),{key:1},{default:I(()=>[(n(),F(pe(s.icon)))]),_:1})):ve(s.$slots,"default",{key:2})],6))}});var Re=me(Qe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/avatar/src/avatar.vue"]]);const Ye=he(Re),Ze={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ge=a("path",{fill:"currentColor",d:"m192 384l320 384l320-384z"},null,-1),Xe=[Ge];function et(c,t){return n(),_("svg",Ze,Xe)}const tt={name:"ep-caret-bottom",render:et},at={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},st=a("path",{fill:"currentColor",d:"M512 320L192 704h639.936z"},null,-1),lt=[st];function ot(c,t){return n(),_("svg",at,lt)}const it={name:"ep-caret-top",render:ot};const nt={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ct=a("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0a224 224 0 1 0-448 0zm544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"},null,-1),rt=[ct];function ut(c,t){return n(),_("svg",nt,rt)}const _t={name:"ep-user-filled",render:ut},G=c=>(Te("data-v-219ae8b9"),c=c(),xe(),c),dt={class:"playlist"},pt={class:"playlist_wrapper"},vt={key:0,class:"playlist_info"},ft={class:"playlist_info_left"},mt={class:"playlist_info_cover"},ht={key:0,class:"playlist_control"},yt={class:"playlist_info_right"},gt={class:"playlist_info_right_line"},St=["title"],wt={class:"playlist_info_right_line"},Ct={class:"playlist_info_nickname"},kt={class:"playlist_info_createTime"},bt={class:"playlist_info_right_line"},Pt={class:"playlise_info_playinfo"},Et=G(()=>a("span",{class:"playlist_info-tip"},"\u6B4C\u66F2:",-1)),It={class:"playlist_info_right_line"},Bt={class:"playlist_info_description"},Dt=G(()=>a("span",{class:"playlist_info-tip"},"\u7B80\u4ECB:",-1)),$t={key:0},zt={class:"playlist_song"},Ft=T({__name:"index",props:{id:null,t:null},setup(c){const t=c,C=Ie(),r=h(!0),k=h(!1),B=h(!1),f=ye([]),e=h(),y=h(!1),s=h(1),P=h(!1),g=h(!1);Y([()=>t.id,()=>t.t],()=>{f.length=0,m();let l=j(t.id);g.value=!!l},{immediate:!0}),ge(()=>{t.t===o.localStorage&&window.addEventListener(U,m)}),Se(()=>{window.removeEventListener(U,m)});async function m(){if(t.t===o.localStorage){r.value=!0;let l=j(t.id);l?(e.value=l,f.length=0,f.push(...l.tracks)):C.replace("/404"),r.value=!1;return}X(t.id,t.t)}async function X(l,p){r.value=!0,k.value=!1;let u,i;switch(p){case o.local:{[u,i]=await We({id:Number(l)});break}case o.cloud:{[u,i]=await we({id:Number(l)});break}case o.bili:{[u,i]=await Ve(String(l));break}}if(r.value=!1,!u&&i){let{code:v,data:D}=i.data;return e.value=Ce(D,p),!0}else return C.replace("/404"),k.value=!0,!1}async function x(l,p,u=!1){B.value=!1;let i,v;switch(p){case o.local:{[i,v]=await je({id:Number(l),limit:s.value});break}case o.cloud:{[i,v]=await Be({id:Number(l),limit:s.value});break}case o.bili:{[i,v]=await Ue(String(l));break}}if(!i&&v){let{code:D,data:$}=v.data;return u||(f.length=0),f.push(...De($,p===o.cloud?J.cloud:J.local)),s.value+=1,$.length}else return t.t===o.localStorage?0:(B.value=!0,-1)}function ee(){y.value=!y.value}function te(l){if(!e.value||e.value.type!==o.localStorage)return;let p={...e.value};p.tracks=l;let u=$e(),i=u.findIndex(v=>v.id===p.id);i!==-1&&(u.splice(i,1,p),ze(u))}async function ae(){if(!!e.value)if(g.value)Le(t.id),g.value=!1,Q({type:"success",message:"\u6B4C\u5355\u53D6\u6D88\u6536\u85CF\u6210\u529F"});else{if(t.t!==o.bili){P.value=!0;let l=0;do l=await x(t.id,t.t,!0);while(l>0);P.value=!1}Ne(e.value,f),g.value=!0,Q({type:"success",message:"\u6536\u85CF\u6210\u529F"})}}return(l,p)=>{var M,A,q,V;const u=qe,i=ke,v=_t,D=Ye,$=it,L=Z,se=tt,le=Ae,oe=Fe("lazy"),N=be;return S((n(),_("div",dt,[w(u,{isError:!r.value&&k.value,requestFunc:m},null,8,["isError"]),S((n(),_("div",pt,[e.value?(n(),_("div",vt,[a("div",ft,[a("div",mt,[S((n(),_("img",{alt:"\u6B4C\u5355\u5C01\u9762",key:e.value.cover})),[[oe,d(K)(e.value.cover)]])]),t.t!==d(o).localStorage?(n(),_("div",ht,[w(i,{class:"playlist_control_btn",color:"#f56c6c",plain:"",onClick:Pe(ae,["stop"])},{default:I(()=>[O(b(g.value?"\u5DF2\u6536\u85CF":"\u6536\u85CF\u6B4C\u5355"),1)]),_:1},8,["onClick"])])):H("",!0)]),a("div",yt,[a("div",gt,[a("h3",{class:"playlist_info_title",title:e.value.title},b(e.value.title),9,St)]),a("div",wt,[(n(),F(D,{class:"playlist_info_avatar",size:36,src:d(K)(e.value.creator.avatarUrl),key:e.value.creator.avatarUrl},{default:I(()=>[w(v)]),_:1},8,["src"])),a("span",Ct,b(e.value.creator.name),1),a("span",kt,b(e.value.createTime===0?"":new Date(e.value.createTime).toLocaleDateString()),1)]),a("div",bt,[a("div",Pt,[Et,O(b(e.value.trackCount),1)])]),a("div",It,[a("div",Bt,[Dt,e.value.description===""?(n(),_("span",$t,"\u65E0")):(n(),_(Ee,{key:1},[S(a("span",{class:"playlist_info_description-title"},b(e.value.description),513),[[E,!y.value]]),S(a("span",{class:"playlist_info_description-full"},b(e.value.description),513),[[E,y.value]]),a("span",{class:"playlist_info_description-arrow",onClick:ee},[S(w(L,null,{default:I(()=>[w($)]),_:1},512),[[E,y.value]]),S(w(L,null,{default:I(()=>[w(se)]),_:1},512),[[E,!y.value]])])],64))])])])])):H("",!0),S(a("div",zt,[w(le,{songs:f,canDeleteSong:((M=e.value)==null?void 0:M.type)===d(o).localStorage,canDrag:((A=e.value)==null?void 0:A.type)===d(o).localStorage,isStatic:((q=e.value)==null?void 0:q.type)===d(o).localStorage||((V=e.value)==null?void 0:V.type)===d(o).bili,loadMoreFunc:x.bind(void 0,t.id,t.t,!0),onSongOrder:te},null,8,["songs","canDeleteSong","canDrag","isStatic","loadMoreFunc"])],512),[[E,e.value]])])),[[N,r.value&&!e.value]])])),[[N,P.value]])}}});const At=Me(Ft,[["__scopeId","data-v-219ae8b9"]]);export{At as default};
