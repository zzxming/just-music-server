import{S as v,T as h,U as y,d as X,V as z,D as G,G as K,h as Q,E as U,W as Z,g as A,s as q,o as n,c,a as i,k as d,I as m,F as f,i as x,t as u,n as tt,X as st,b as P,Y as et,Z as at,j as T,$ as ot,M as it,N as lt,K as nt,_ as ct}from"./index.c964b01d.js";const Ft=async o=>await v(h.get(y("/bili/info",{bv:o}))),Mt=async o=>(o.limit||(o.limit=1),o.t||(o.t=1),await v(h.get(y("/music/search/local",o)))),Yt=async o=>await v(h.get(y("/music/local/info",o))),jt=async o=>await v(h.get(y("/music/local/playlist/detail",o))),Et=async o=>await v(h.get(y("/music/local/playlist/track",o))),L=o=>(it("data-v-8c30c4b0"),o=o(),lt(),o),rt={class:"songlist"},dt={class:"songlist_header"},ut=L(()=>i("div",{class:"songlist_index"},null,-1)),_t=L(()=>i("div",{class:"songlist_title"},"\u6807\u9898",-1)),pt={key:0,class:"songlist_singer"},gt=L(()=>i("div",{class:"songlist_duration"},"\u65F6\u95F4",-1)),mt={class:"songlist_body"},ft=["draggable","onDblclick","onContextmenu","onDragstart","onDrop"],vt={class:"songlist_index"},ht={class:"songlist_index-text"},yt={class:"el-icon songlist_index-icon playing"},Dt={class:"songlist_title"},St={class:"songlist_title-title"},bt=["title"],xt={key:0,class:"el-icon songlist_title-icon"},Lt=["title"],It={class:"songlist_singer"},kt={class:"songlist_singer_item"},Ct=["title"],At={class:"songlist_singer"},Pt={class:"songlist_singer_item"},Tt={class:"songlist_duration"},wt={class:"songlist_duration"},Bt={key:0,class:"songlist_empty"},Nt=X({__name:"index",props:{songs:null,emptyText:{default:"\u8FD9\u91CC\u4EC0\u4E48\u90FD\u6CA1\u6709"},canDeleteSong:{type:Boolean,default:!1},canDrag:{type:Boolean,default:!1}},emits:["songOrder"],setup(o,{emit:w}){const _=o,b=z(),I=G(),B=K(),N=Q(),{audioInfo:p}=U(I),{setAudioInfo:V}=I,{playinglistReplace:F}=B,{setPopoutState:M}=N,{songs:D,emptyText:Y}=Z(_),S=A(p.value.id),k=A(p.value.cid);q(p,a=>{S.value=a.id,k.value=a.cid});async function j(a,e){(p.value.id!==e.id||p.value.type===nt.bili&&p.value.cid!==e.cid)&&(S.value=e.id,S.value=e.cid,V(e),F(D.value))}function E(a,e){a.preventDefault(),M({popoutVisible:!0,popoutPosition:{left:a.pageX,top:a.pageY},popoutHoldData:e,popoutIsMusic:!0,popoutCanDelete:_.canDeleteSong})}function O(a,e){var t;!_.canDrag||(t=a.dataTransfer)==null||t.setData("data",JSON.stringify(e))}function $(a){!_.canDrag||a.target&&(a.target.classList.remove("top"),a.target.classList.remove("bottom"))}function R(a){if(!_.canDrag)return;a.preventDefault();let e=a.composedPath().find(l=>Array.from(l.classList).includes("songlist_item")),t=e.offsetHeight,r=e.offsetTop;a.pageY<r+t/2?(e.classList.add("top"),e.classList.remove("bottom")):(e.classList.remove("top"),e.classList.add("bottom"))}function W(a,e){var C;if(!_.canDrag)return;let t=a.composedPath().find(J=>Array.from(J.classList).includes("songlist_item")),r=Array.from(t.classList),s=JSON.parse((C=a.dataTransfer)==null?void 0:C.getData("data")),l=e;if(r.includes("bottom")&&(l+=1),l<0&&(l=0),l===s){t.classList.remove("top"),t.classList.remove("bottom");return}let g=[...D.value],H=g[s];g.splice(l,0,H),l<s?g.splice(s+1,1):g.splice(s,1),w("songOrder",g),t.classList.remove("top"),t.classList.remove("bottom")}return(a,e)=>(n(),c("div",rt,[i("div",dt,[ut,_t,d(b)?m("",!0):(n(),c("div",pt,"\u6B4C\u624B")),gt]),i("div",mt,[(n(!0),c(f,null,x(d(D),(t,r)=>(n(),c("div",{class:tt(`songlist_item ${r%2===0?"stripe":""} ${S.value===t.id&&k.value===t.cid?"active":""} ${t.st===-200?"disable":""}`),draggable:o.canDrag,onDblclick:s=>j(s,t),onContextmenu:s=>E(s,t),onDragstart:s=>O(s,r),onDragleave:e[0]||(e[0]=s=>$(s)),onDragover:e[1]||(e[1]=s=>R(s)),onDrop:s=>W(s,r)},[i("div",vt,[i("span",ht,u(d(st)(r+1)),1),i("span",yt,[P(et)])]),i("div",Dt,[i("div",St,[i("span",{class:"songlist_title-text",title:t.title},u(t.title),9,bt),t.fee===1?(n(),c("span",xt,[P(at)])):m("",!0)]),d(b)?(n(),c("div",{key:0,class:"songlist_title-singer",title:t.singers.map(s=>s.name).join(" / ")},[i("span",It,[(n(!0),c(f,null,x(t.singers,(s,l)=>(n(),c(f,null,[i("span",kt,u(s.name),1),T(" "+u(l===t.singers.length-1?"":"\xA0/\xA0"),1)],64))),256))])],8,Lt)):m("",!0)]),d(b)?m("",!0):(n(),c("div",{key:0,class:"songlist_singer",title:t.singers.map(s=>s.name).join(" / ")},[i("span",At,[(n(!0),c(f,null,x(t.singers,(s,l)=>(n(),c(f,null,[i("span",Pt,u(s.name),1),T(" "+u(l===t.singers.length-1?"":"\xA0/\xA0"),1)],64))),256))])],8,Ct)),i("div",Tt,[i("span",wt,u(d(ot)(t.duration/1e3)),1)])],42,ft))),256)),d(D).length<1?(n(),c("div",Bt,u(d(Y)),1)):m("",!0)])]))}});const Ot=ct(Nt,[["__scopeId","data-v-8c30c4b0"]]);export{Ot as S,jt as a,Et as b,Mt as c,Yt as g,Ft as s};
